<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petualangan Sinonim Cilik</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Fredoka untuk tampilan anak-anak yang fun -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #0ea5e9;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.1) 20%, transparent 20.1%),
                radial-gradient(circle at 90% 80%, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.1) 20%, transparent 20.1%);
            background-size: 100% 100%;
            user-select: none;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        #game-container {
            width: 100%;
            max-width: 1024px;
            aspect-ratio: 16/9;
            background: #f0f9ff;
            border-radius: 2rem;
            box-shadow: 0 25px 0px rgba(0,0,0,0.15);
            border: 8px solid #ffffff;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER LEVEL --- */
        .level-header {
            width: 100%;
            background-color: #ffffff;
            border-bottom: 4px solid #e0f2fe;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 40;
            gap: 1rem;
            height: 80px;
            position: relative; 
        }

        .level-card {
            padding: 0.5rem 1.5rem;
            border-radius: 99px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            position: relative;
            border: 3px solid transparent;
            cursor: default;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
        }

        .level-active {
            background-color: #38bdf8;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(56, 189, 248, 0.3);
            border-color: #0284c7;
        }

        .level-inactive {
            background-color: #f1f5f9;
            color: #cbd5e1;
            transform: scale(0.95);
            opacity: 0.7; 
        }

        /* --- MAIN CONTENT & ANIMASI --- */
        .main-content {
            flex: 1;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            padding-bottom: 1rem;
            
            /* Animasi Pergantian Warna Dasar */
            animation: color-cycle 50s infinite; 
            background-color: #7dd3fc;
        }

        @keyframes color-cycle {
            0%   { background-color: #7dd3fc; } /* Biru */
            18%  { background-color: #7dd3fc; } 
            20%  { background-color: #fde047; } /* Kuning */
            38%  { background-color: #fde047; } 
            40%  { background-color: #fca5a5; } /* Merah */
            58%  { background-color: #fca5a5; } 
            60%  { background-color: #86efac; } /* Hijau */
            78%  { background-color: #86efac; } 
            80%  { background-color: #d8b4fe; } /* Ungu */
            98%  { background-color: #d8b4fe; } 
            100% { background-color: #7dd3fc; } 
        }

        .main-content::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-conic-gradient(
                from 0deg,
                rgba(255, 255, 255, 0.4) 0deg 15deg, 
                transparent 15deg 30deg
            );
            animation: rotate-sunburst 60s linear infinite;
            z-index: 0;
        }

        @keyframes rotate-sunburst {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .screen {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 2rem;
            width: 100%;
            height: 100%;
            z-index: 1; 
        }

        /* --- QUESTION BOARD --- */
        .question-board {
            background: #fde047;
            padding: 1.5rem 3rem;
            border-radius: 2rem;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            text-align: center;
            border: 4px solid #facc15;
            width: 90%;
            max-width: 800px;
            position: relative;
        }
        
        .question-board::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 20px 20px 0;
            border-style: solid;
            border-color: #eab308 transparent transparent transparent;
        }
         .question-board::before {
            content: '';
            position: absolute;
            bottom: -14px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 20px 20px 0;
            border-style: solid;
            border-color: #fde047 transparent transparent transparent;
            z-index: 1;
        }

        /* --- BUTTONS --- */
        .btn-option {
            transition: all 0.1s;
            border-bottom-width: 8px;
            border-radius: 1.5rem;
            text-transform: capitalize;
            position: relative;
            top: 0;
            white-space: normal; 
            line-height: 1.2;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Inisialisasi opacity 0 untuk animasi masuk */
            opacity: 0; 
        }

        .btn-option:active {
            top: 8px;
            border-bottom-width: 0px;
            transform: translateY(2px);
            box-shadow: inset 0 4px 6px rgba(0,0,0,0.1);
        }

        .opt-0 { background-color: #ff6b6b; border-color: #c92a2a; color: white; } 
        .opt-0:hover { background-color: #ff8787; }
        .opt-1 { background-color: #fcc419; border-color: #e67700; color: #5f370e; } 
        .opt-1:hover { background-color: #ffd43b; }
        .opt-2 { background-color: #51cf66; border-color: #2b8a3e; color: white; } 
        .opt-2:hover { background-color: #69db7c; }
        .opt-3 { background-color: #4dabf7; border-color: #1971c2; color: white; } 
        .opt-3:hover { background-color: #74c0fc; }

        .btn-option.correct {
            background-color: #22c55e !important;
            border-color: #14532d !important;
            color: white !important;
            opacity: 1 !important; /* Pastikan opacity 1 saat hasil */
        }

        .btn-option.wrong {
            background-color: #ef4444 !important;
            border-color: #7f1d1d !important;
            opacity: 0.6 !important;
            animation: shake 0.4s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .timer-wrapper {
            background: white;
            padding: 8px;
            border-radius: 99px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.05);
            margin-top: auto;
            margin-bottom: 0.5rem;
        }
        
        .timer-bar-bg {
            width: 100%;
            height: 16px;
            background-color: #f1f5f9;
            border-radius: 99px;
            overflow: hidden;
            position: relative;
        }

        .timer-bar {
            height: 100%;
            background: linear-gradient(90deg, #facc15, #f97316);
            width: 100%;
            border-radius: 99px;
            transform-origin: left;
        }

        .animate-timer {
            animation: shrink 5s linear forwards;
        }

        @keyframes shrink {
            0% { width: 100%; background: #4ade80; }
            50% { background: #facc15; }
            100% { width: 0%; background: #ef4444; }
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            z-index: 50;
        }

        .header-text {
            background: white;
            padding: 0.5rem 1.5rem;
            border-radius: 99px;
            font-size: 1rem;
            font-weight: 800;
            color: #0284c7;
            box-shadow: 0 3px 0 #bae6fd;
            border: 2px solid #e0f2fe;
            margin-right: 1rem;
        }

        /* --- ANIMASI ZOOM OUT UNTUK SOAL --- */
        @keyframes zoom-out-enter {
            0% { transform: scale(2.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .animate-zoom-out {
            animation: zoom-out-enter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        /* --- ANIMASI ZOOM IN (POP UP) UNTUK OPSI --- */
        @keyframes zoom-in-pop {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .animate-pop-in {
            /* 0.4s durasi, efek membal (cubic-bezier) */
            animation: zoom-in-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @media (max-width: 640px) {
            #game-container {
                height: 100vh;
                width: 100vw;
                max-width: none;
                border: none;
                border-radius: 0;
            }
            .level-header {
                height: 60px;
                padding: 0.5rem;
                gap: 0.5rem;
                justify-content: center;
            }
            .level-card {
                padding: 0.25rem 0.8rem;
                font-size: 0.8rem;
            }
            .level-card span:first-child { 
                display: none;
            }
            .question-board {
                padding: 1rem;
                margin-top: 0.5rem;
            }
            h2 { font-size: 2rem; }
            .btn-option {
                padding: 1rem;
                font-size: 1.25rem !important;
            }
            .header-text {
                display: none;
            }
        }
    </style>
</head>
<body>

    <!-- Container Utama -->
    <div id="game-container">
        
        <!-- HEADER LEVEL -->
        <div class="level-header">
            
            <div id="badge-level-0" class="level-card lvl-mudah level-inactive ml-12 sm:ml-0">
                <span>ðŸŒ±</span>
                <span>MUDAH</span>
            </div>

            <div class="text-sky-200 text-sm"><i class="fas fa-chevron-right"></i></div>

            <div id="badge-level-1" class="level-card lvl-sedang level-inactive">
                <span>ðŸŒ¿</span>
                <span>SEDANG</span>
            </div>

            <div class="text-sky-200 text-sm"><i class="fas fa-chevron-right"></i></div>

            <div id="badge-level-2" class="level-card lvl-sulit level-inactive">
                <span>ðŸŒ³</span>
                <span>SULIT</span>
            </div>

            <!-- Judul Kecil di Kanan (Desktop Only) -->
            <div class="ml-auto header-text hidden sm:block">
                Asah Kosakata mu
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            
            <!-- Halaman Awal -->
            <div id="start-screen" class="screen z-20 bg-white/90 backdrop-blur-sm">
                <div class="text-center max-w-lg">
                    <h1 class="text-6xl font-black text-sky-500 mb-2 drop-shadow-sm tracking-tighter" style="-webkit-text-stroke: 2px #0ea5e9;">TEBAK SINONIM</h1>
                    <div class="bg-yellow-400 text-yellow-900 inline-block px-4 py-1 rounded-full font-bold mb-8 transform -rotate-2 border-2 border-yellow-600">Edisi Petualang Cilik</div>
                    <br>
                    <button onclick="startGame()" class="bg-green-500 hover:bg-green-600 text-white font-black py-4 px-16 rounded-3xl text-3xl shadow-[0_8px_0_#15803d] active:shadow-none active:translate-y-[8px] transition-all animate-pulse">
                        MULAI MAIN â–¶
                    </button>
                    <p class="mt-4 text-gray-500 text-sm font-bold"><i class="fas fa-volume-up mr-1"></i> Jangan lupa nyalakan suara!</p>
                </div>
            </div>

            <!-- Halaman Game -->
            <div id="game-screen" class="screen hidden">
                <div class="flex flex-col items-center justify-center w-full h-full">
                    
                    <div class="question-board">
                        <p class="text-yellow-800 font-bold tracking-widest text-sm mb-2 uppercase">Apa persamaan kata dari</p>
                        <h2 id="question-word" class="text-6xl font-black text-black drop-shadow-sm">???</h2>
                    </div>

                    <div id="options-container" class="grid grid-cols-2 gap-4 w-full max-w-4xl px-4 mt-2">
                        <!-- Tombol generate by JS -->
                    </div>

                    <div class="timer-wrapper">
                        <div class="timer-bar-bg">
                            <div id="timer-bar" class="timer-bar"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Halaman Hasil Akhir -->
            <div id="result-screen" class="screen hidden bg-white/95 z-30">
                <div class="flex flex-col items-center animate-fade-in text-center">
                    <div id="result-emoji" class="text-9xl mb-6">ðŸŽ‰</div>
                    <h2 class="text-5xl font-black text-sky-500 mb-2">HEBAT!</h2>
                    <p class="text-xl text-slate-400 font-bold mb-8">Permainan Selesai</p>
                    
                    <div class="bg-yellow-100 border-4 border-yellow-400 p-8 rounded-3xl mb-10 w-64 transform rotate-1 shadow-lg">
                        <p class="text-yellow-700 font-bold mb-2 uppercase text-sm">Skor Akhir</p>
                        <div class="text-7xl font-black text-yellow-500">
                            <span id="final-score">0</span>
                        </div>
                    </div>

                    <button onclick="location.reload()" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-4 px-10 rounded-2xl text-2xl shadow-[0_6px_0_#0369a1] active:shadow-none active:translate-y-[6px] transition-all">
                        MAIN LAGI ðŸ”„
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- Script Logic -->
    <script>
        // Data Game - TOTAL 60 SOAL (20 Mudah, 20 Sedang, 20 Sulit)
        const gameData = [
            {
                levelName: "MUDAH",
                questions: [
                    { word: "Senang", options: ["Gembira", "Sedih", "Marah", "Takut"], answer: 0 },
                    { word: "Besar", options: ["Kecil", "Jumbo", "Tipis", "Pendek"], answer: 1 },
                    { word: "Cantik", options: ["Jelek", "Indah", "Kotor", "Buruk"], answer: 1 },
                    { word: "Cepat", options: ["Lambat", "Pelan", "Laju", "Diam"], answer: 2 },
                    { word: "Benar", options: ["Betul", "Salah", "Bohong", "Palsu"], answer: 0 },
                    { word: "Kecil", options: ["Mungil", "Raksasa", "Luas", "Tinggi"], answer: 0 },
                    { word: "Pintar", options: ["Bodoh", "Pandai", "Malas", "Lambat"], answer: 1 },
                    { word: "Bersih", options: ["Kotor", "Debu", "Bening", "Gelap"], answer: 2 },
                    { word: "Marah", options: ["Senyum", "Kesal", "Tawa", "Suka"], answer: 1 },
                    { word: "Lari", options: ["Jalan", "Duduk", "Joging", "Tidur"], answer: 2 },
                    { word: "Sedih", options: ["Ceria", "Murung", "Tawa", "Senyum"], answer: 1 },
                    { word: "Takut", options: ["Berani", "Ngeri", "Kuat", "Hebat"], answer: 1 },
                    { word: "Kaya", options: ["Makmur", "Miskin", "Susah", "Kurang"], answer: 0 },
                    { word: "Rajin", options: ["Giat", "Malas", "Santai", "Lambat"], answer: 0 },
                    { word: "Panas", options: ["Dingin", "Beku", "Terik", "Sejuk"], answer: 2 },
                    { word: "Mahal", options: ["Murah", "Rendah", "Berharga", "Gratis"], answer: 2 },
                    { word: "Tinggi", options: ["Jangkung", "Pendek", "Rendah", "Kecil"], answer: 0 },
                    { word: "Gemuk", options: ["Kurus", "Langsing", "Gendut", "Tipis"], answer: 2 },
                    { word: "Melihat", options: ["Mendengar", "Menonton", "Meraba", "Mencium"], answer: 1 },
                    { word: "Teman", options: ["Musuh", "Lawan", "Kawan", "Asing"], answer: 2 }
                ]
            },
            {
                levelName: "SEDANG",
                questions: [
                    { word: "Lelah", options: ["Letih", "Semangat", "Kuat", "Segar"], answer: 0 },
                    { word: "Sukar", options: ["Mudah", "Gampang", "Sulit", "Ringan"], answer: 2 },
                    { word: "Bohong", options: ["Jujur", "Dusta", "Asli", "Tulus"], answer: 1 },
                    { word: "Indah", options: ["Buruk", "Permai", "Rusak", "Kacau"], answer: 1 },
                    { word: "Wafat", options: ["Lahir", "Hidup", "Meninggal", "Bangun"], answer: 2 },
                    { word: "Hadiah", options: ["Hukuman", "Denda", "Cenderamata", "Tagihan"], answer: 2 },
                    { word: "Pakaian", options: ["Busana", "Topi", "Sepatu", "Tas"], answer: 0 },
                    { word: "Hewan", options: ["Tanaman", "Satwa", "Benda", "Manusia"], answer: 1 },
                    { word: "Bunga", options: ["Daun", "Akar", "Puspa", "Batang"], answer: 2 },
                    { word: "Matahari", options: ["Bulan", "Bintang", "Surya", "Langit"], answer: 2 },
                    { word: "Haus", options: ["Lapar", "Kenyang", "Dahaga", "Puas"], answer: 2 },
                    { word: "Tempat", options: ["Waktu", "Lokasi", "Cara", "Alat"], answer: 1 },
                    { word: "Wajah", options: ["Tangan", "Kaki", "Paras", "Badan"], answer: 2 },
                    { word: "Tubuh", options: ["Raga", "Jiwa", "Pikiran", "Rasa"], answer: 0 },
                    { word: "Bertemu", options: ["Berpisah", "Berjumpa", "Menjauh", "Hilang"], answer: 1 },
                    { word: "Menolong", options: ["Membantu", "Membiarkan", "Melihat", "Menjauhi"], answer: 0 },
                    { word: "Sombong", options: ["Rendah Hati", "Angkuh", "Baik", "Ramah"], answer: 1 },
                    { word: "Hemat", options: ["Boros", "Mewah", "Irit", "Mahal"], answer: 2 },
                    { word: "Khawatir", options: ["Tenang", "Damai", "Cemas", "Senang"], answer: 2 },
                    { word: "Aneh", options: ["Biasa", "Ganjil", "Normal", "Umum"], answer: 1 }
                ]
            },
            {
                levelName: "SULIT",
                questions: [
                    { word: "Egois", options: ["Peduli", "Mau Menang Sendiri", "Dermawan", "Setia"], answer: 1 },
                    { word: "Unik", options: ["Biasa", "Khas", "Umum", "Normal"], answer: 1 },
                    { word: "Hadir", options: ["Datang", "Pergi", "Absen", "Hilang"], answer: 0 },
                    { word: "Realita", options: ["Mimpi", "Khayalan", "Kenyataan", "Dongeng"], answer: 2 },
                    { word: "Generasi", options: ["Individu", "Angkatan", "Kelompok", "Teman"], answer: 1 },
                    { word: "Evolusi", options: ["Perubahan", "Tetap", "Mundur", "Diam"], answer: 0 },
                    { word: "Global", options: ["Lokal", "Desa", "Mendunia", "Sempit"], answer: 2 },
                    { word: "Tradisi", options: ["Baru", "Modern", "Adat", "Asing"], answer: 2 },
                    { word: "Kompetisi", options: ["Persaingan", "Kerjasama", "Damai", "Bantuan"], answer: 0 },
                    { word: "Kolaborasi", options: ["Sendiri", "Lawan", "Kerjasama", "Pisah"], answer: 2 },
                    { word: "Solusi", options: ["Masalah", "Penyelesaian", "Hambatan", "Rintangan"], answer: 1 },
                    { word: "Identitas", options: ["Nama", "Jati Diri", "Alamat", "Hobi"], answer: 1 },
                    { word: "Kualitas", options: ["Jumlah", "Harga", "Mutu", "Bentuk"], answer: 2 },
                    { word: "Prioritas", options: ["Terakhir", "Utama", "Pilihan", "Sampingan"], answer: 1 },
                    { word: "Fleksibel", options: ["Kaku", "Keras", "Luwes", "Patah"], answer: 2 },
                    { word: "Metode", options: ["Alat", "Bahan", "Cara", "Hasil"], answer: 2 },
                    { word: "Target", options: ["Asal", "Sasaran", "Jalan", "Mulai"], answer: 1 },
                    { word: "Dialog", options: ["Diam", "Monolog", "Percakapan", "Pidato"], answer: 2 },
                    { word: "Logika", options: ["Perasaan", "Emosi", "Nalar", "Mimpi"], answer: 2 },
                    { word: "Inspirasi", options: ["Bosan", "Tidur", "Ilham", "Lupa"], answer: 2 }
                ]
            }
        ];

        let currentLevelIndex = 0;
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswering = false;
        let timerTimeout;

        // Elements
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const questionWord = document.getElementById('question-word');
        const optionsContainer = document.getElementById('options-container');
        const timerBar = document.getElementById('timer-bar');

        // Speech Function
        function speakText(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'id-ID'; 
                utterance.rate = 1.0; 
                utterance.pitch = 1.1; 
                window.speechSynthesis.speak(utterance);
            }
        }

        // Sound Effects (SFX)
        function playSound(type) {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                oscillator.type = 'triangle'; 
                oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                oscillator.frequency.linearRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                oscillator.type = 'sine'; 
                oscillator.frequency.setValueAtTime(300, audioCtx.currentTime); 
                oscillator.frequency.exponentialRampToValueAtTime(600, audioCtx.currentTime + 0.3);
                // Volume dinaikkan 100% (dari 0.3 menjadi 0.6)
                gainNode.gain.setValueAtTime(0.6, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            }
        }

        // Update Sidebar
        function updateSidebar() {
            for (let i = 0; i < 3; i++) {
                const badge = document.getElementById(`badge-level-${i}`);
                if (i === currentLevelIndex) {
                    badge.classList.remove('level-inactive');
                    badge.classList.add('level-active');
                } else {
                    badge.classList.remove('level-active');
                    badge.classList.add('level-inactive');
                }
            }
        }

        function startGame() {
            startScreen.classList.add('hidden');
            score = 0;
            currentLevelIndex = 0;
            startLevel();
        }

        function startLevel() {
            currentQuestionIndex = 0;
            updateSidebar();
            gameScreen.classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            isAnswering = false;
            const currentLevel = gameData[currentLevelIndex];
            const currentQ = currentLevel.questions[currentQuestionIndex];

            // Reset Animasi Zoom Out
            questionWord.classList.remove('animate-zoom-out');
            void questionWord.offsetWidth; // Trigger Reflow (Reset CSS Animation)
            questionWord.classList.add('animate-zoom-out');

            questionWord.textContent = currentQ.word;
            optionsContainer.innerHTML = '';

            speakText("Apa persamaan kata dari " + currentQ.word + "?");
            
            currentQ.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                // UPDATE: Menambahkan class 'animate-pop-in' untuk animasi Zoom In
                btn.className = `btn-option w-full py-6 px-4 text-3xl md:text-3xl font-bold shadow-sm opt-${index} animate-pop-in`;
                btn.textContent = opt;
                btn.onclick = () => checkAnswer(index, btn);
                // Menambahkan delay bertahap agar tombol muncul berurutan
                btn.style.animationDelay = `${index * 0.1}s`; 
                optionsContainer.appendChild(btn);
            });

            timerBar.classList.remove('animate-timer');
            void timerBar.offsetWidth; 
            timerBar.classList.add('animate-timer');

            clearTimeout(timerTimeout);
            timerTimeout = setTimeout(() => {
                if(!isAnswering) handleTimeOut();
            }, 5000);
        }

        function checkAnswer(selectedIndex, btnElement) {
            if (isAnswering) return;
            isAnswering = true;
            
            if ('speechSynthesis' in window) window.speechSynthesis.cancel();

            clearTimeout(timerTimeout);
            timerBar.style.animationPlayState = 'paused';

            const currentLevel = gameData[currentLevelIndex];
            const correctIndex = currentLevel.questions[currentQuestionIndex].answer;
            const correctText = currentLevel.questions[currentQuestionIndex].options[correctIndex]; 
            
            const buttons = optionsContainer.children;

            for (let i = 0; i < buttons.length; i++) {
                buttons[i].disabled = true; 
                
                if (i === correctIndex) {
                    buttons[i].classList.add('correct');
                    buttons[i].classList.remove('opacity-80'); 
                    buttons[i].style.transform = "scale(1.05)";
                    buttons[i].style.zIndex = "10";
                    buttons[i].style.filter = "none";
                } else if (i === selectedIndex) {
                    buttons[i].classList.add('wrong');
                    buttons[i].style.opacity = "0.5";
                } else {
                    buttons[i].classList.add('opacity-20', 'blur-sm');
                }
            }

            if (selectedIndex === correctIndex) {
                btnElement.innerHTML += ' <i class="fas fa-check ml-2"></i>';
                playSound('correct');
                score += 10 + (currentLevelIndex * 5);
                speakText("Benar! " + correctText);
            } else {
                btnElement.innerHTML += ' <i class="fas fa-times ml-2"></i>';
                playSound('wrong');
                speakText(correctText);
            }

            setTimeout(nextQuestion, 2500); 
        }

        function handleTimeOut() {
            isAnswering = true;
            if ('speechSynthesis' in window) window.speechSynthesis.cancel();

            playSound('wrong');
            const currentLevel = gameData[currentLevelIndex];
            const correctIndex = currentLevel.questions[currentQuestionIndex].answer;
            const correctText = currentLevel.questions[currentQuestionIndex].options[correctIndex]; 

            const buttons = optionsContainer.children;
            
            for (let i = 0; i < buttons.length; i++) {
                buttons[i].disabled = true;
                
                if (i === correctIndex) {
                    // Tunjukkan Jawaban Benar (Tanpa icon jam)
                    buttons[i].classList.add('correct');
                    buttons[i].style.transform = "scale(1.05)";
                    buttons[i].style.zIndex = "10";
                } else {
                    // Kaburkan sisanya
                    buttons[i].classList.add('opacity-20', 'blur-sm');
                }
            }
            
            speakText(correctText);

            setTimeout(nextQuestion, 2500);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < gameData[currentLevelIndex].questions.length) {
                loadQuestion();
            } else {
                if (currentLevelIndex < gameData.length - 1) {
                    currentLevelIndex++;
                    startLevel();
                } else {
                    gameScreen.classList.add('hidden');
                    showGameOver();
                }
            }
        }

        function showGameOver() {
            resultScreen.classList.remove('hidden');
            document.getElementById('final-score').textContent = score;
            if(score > 80) createConfetti();
            
            speakText("Permainan selesai! Skor kamu " + score);
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const c = document.createElement('div');
                c.className = 'confetti';
                c.style.backgroundColor = ['#f00','#0f0','#00f','#ff0'][Math.floor(Math.random()*4)];
                c.style.left = Math.random()*100 + '%';
                c.style.top = -10 + 'px';
                c.style.animation = `fall ${2+Math.random()*3}s linear forwards`;
                document.getElementById('game-container').appendChild(c);
            }
        }
    </script>
</body>
</html>
